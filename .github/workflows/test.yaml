name: üóÉÔ∏è test Manager Archive

on:
  workflow_dispatch:

env:
  PACKAGE_MANAGER_DIR: D:\00PackageManager
  CHOCO_CACHE: D:\ChocoCache
  CHOCOLATEYINSTALL: D:\00PackageManager\chocolatey
  CHOCOLATEYLASTPATHUPDATE: D:\00PackageManager\chocolatey\tools

jobs:
  build-and-deploy:
    runs-on: windows-latest

    steps:
    - name: Check Admin Rights
      shell: pwsh
      run: |
        $isAdmin = ([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)
        Write-Host "Is Administrator: $isAdmin"

    - name: Setup Chocolatey
      shell: pwsh
      run: |
        # ÂàõÂª∫ÂøÖË¶ÅÁõÆÂΩï
        New-Item -Path $env:PACKAGE_MANAGER_DIR -ItemType Directory -Force
        New-Item -Path $env:CHOCO_CACHE -ItemType Directory -Force
        New-Item -Path $env:CHOCOLATEYINSTALL -ItemType Directory -Force
        New-Item -Path $env:CHOCOLATEYLASTPATHUPDATE -ItemType Directory -Force

    - name: Install Chocolatey
      shell: pwsh
      run: |
        Set-ExecutionPolicy Bypass -Scope Process -Force;
        [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072;
        [Environment]::SetEnvironmentVariable("ChocolateyInstall", $customChocoPath, "Machine")
        [Environment]::SetEnvironmentVariable("ChocolateyLastPathUpdate", $customToolsPath, "Machine")
        iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))

    - name: Install Packages with Chocolatey
      shell: pwsh
      run: |
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE 7zip
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE adb
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE apktool
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE aria2
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE base64
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE biome
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE chromedriver
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE cmake
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE codeql
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE colortool
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE curl
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE dismplusplus
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE dos2unix
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE dupeguru
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE etcd
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE Everything
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE exiftool
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE fd
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE ffmpeg
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE Firefox
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE fscapture
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE gawk
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE git-lfs
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE go
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE GoogleChrome
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE gradle
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE grep
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE hashcat
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE imagemagick
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE innounp
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE jadx
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE jq
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE keepass
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE keepassxc
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE kubernetes-cli
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE ldapadmin
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE less
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE make
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE maven
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE nircmd
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE nodejs-lts
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE obsidian
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE office-tool
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE onefetch
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE openhashtab
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE OpenSSL.Light
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE osv-scanner
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE picgo
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE pandoc
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE peazip
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE powertoys
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE python
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE renamer
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE ruby
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE rufus
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE rust
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE rust-msvc
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE rustup-msvc
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE s3browser
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE scoop-search
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE screentogif
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE sed
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE sharex
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE shellcheck
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE snipaste
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE SpaceSniffer
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE spray
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE sqlitestudio
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE ssh-config
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE sslscan
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE sublime-text
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE sudo
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE sumatrapdf
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE sysinternals
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE tableplus
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE touch
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE TrafficMonitor
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE UniGetUI
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE vcredist2010
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE vcredist2012
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE vcredist2013
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE vcredist2022
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE vim
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE vncviewer
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE vscodium
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE wget
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE which
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE wireshark
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE xmlnotepad
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE yara
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE yarn
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE yq
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE zombie
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE zotero
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE windows-terminal
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE windowsdesktop-runtime-lts
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') install --yes --cache-location $env:CHOCO_CACHE PicView
        & (Join-Path $env:ChocolateyInstall 'bin/choco.exe') list

    - name: Install Packages with Chocolatey
      shell: pwsh
      run: |
        tree /f $env:CHOCOLATEYINSTALL
        tree /f $env:CHOCOLATEYLASTPATHUPDATE
        tree /f $env:PACKAGE_MANAGER_DIR
        tree /f $env:CHOCO_CACHE
